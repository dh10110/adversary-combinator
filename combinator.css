@import url('https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap');

:root {
    --bg: #ffffff;
    --fg: #333333;
    --theme-color: #8A00C4;
    --header-bg: var(--theme-color);
    --header-fg: #fafafa;
    --hover-bg: oklch(95% 0 0);

    --leading-color: var(--theme-color);
    --supporting-color: oklch(from var(--theme-color) l c 120);
    --loss-color: oklch(from var(--theme-color) l c 30);
    --theme-grey: oklch(from var(--theme-color) l 0 0);

    interpolate-size: allow-keywords;

    @media (prefers-color-scheme: dark) {
        --bg: #1a1a1a;
        --fg: #f0f0f0;
        --hover-bg: oklch(25% 0 0);
    }
}

h1, h2, h3 {
    font-family: 'Josefin Sans', sans-serif;
    margin: 0.2em 0 0;
}

body {
    margin: 0;
    padding: 0;
    font-family: "Noto Sans", sans-serif;
    font-optical-sizing: auto;
    background-color: var(--bg);
    color: var(--fg);
    min-block-size: 100vb;
    display: grid;
    grid-template-rows: auto 1fr auto;
    
    > header {
        padding: 0.75em;
        padding-bottom: 0.5em;
        background-color: var(--header-bg);
        color: var(--header-fg);
        background-image: linear-gradient(to right, var(--leading-color), var(--supporting-color));

        h1 {
            margin: 0;
            font-size: 125%;
        }
    }

    > main{
        padding: 1ch;
    }

    > footer {
        font-size: small;
        padding: 0.25em;
        margin-top: 1ch;
        padding-top: 1ch;
        text-align: right;

        > p {
            margin: 0;
        }
    }
}

button, input { font: inherit; }

button { cursor: pointer; }
[type="range"] { cursor: pointer; }


details {
    --toggle-duration: 200ms;

    & > summary {
        list-style-position: outside;
        margin-inline-start: 1rem;
        cursor: pointer;        
        font-size: 115%;
        padding: 0.4em;
        border-radius: 5px;

        &::marker {
            color: oklch(60% 0 0);
        }

        &:hover {
            background-color: var(--hover-bg);
        }
 
        & > h2 { 
            margin: 0;
            display: inline;
            font-size: inherit;
        }
    }

    &::details-content {
        padding-top: 0.5em;

        transition: opacity var(--toggle-duration),
            content-visibility var(--toggle-duration) allow-discrete,
            block-size var(--toggle-duration) ease-out;
    }

    &:not([open])::details-content {
        opacity: 0;
        block-size: 0;
    }
    &[open]::details-content {
        content-visibility: visible;
        opacity: 1;
        block-size: auto;
    }

    &[open] > summary > .when-closed {
        display: none;
    }
    &:not([open]) > summary > .when-open {
        display: none;
    }

}


.adversary-selection {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    /* grid-template-rows: 30% 2em 30%; */

    column-gap: 0.5ch;
    max-width: 65ch;
    margin-inline: auto;
    
    > button {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.25em;
    }


    > article {
        display: grid;
        grid-template-rows: auto 1fr auto;

        &#leading-selection {
            --local-color: var(--leading-color);
        }
        &#supporting-selection {
            --local-color: var(--supporting-color);
            > h2 {
                text-align: right;
            }
        }
        &[data-adv="NONE"] > label {
            visibility: hidden;
        }     

        > h2 {
            margin: 0.1em;
            font-size: 100%;
        }
        > button {
            aspect-ratio: 3/2;
        }
        > label {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
            font-size: smaller;
        }
        [type="range"] {
            accent-color: var(--local-color);
        }
    }

}

.adversary-selection > dialog {
    --local-color: #888;
    background-color: var(--bg);
    color: var(--fg);
    border-color: var(--local-color);
    padding: 0;

    > header {
        background-color: var(--local-color);
        color: var(--header-fg);
        margin: auto;
        > h2 {
            margin: 0;
            font-size: normal;
        }
    }
    ul {
        --cols: 2;

        margin: 0;
        padding: 1ch;
        list-style: none;

        display: grid;
        grid-template-columns: repeat(var(--cols), 1fr);
        flex-wrap: wrap;
        gap: 0.5ch;
        margin-inline: auto;

        @media (width > 450px) {
            --cols: 3;
        }

        > li {
            /*min-width: 15ch;*/
            /*width: 32%;*/
            aspect-ratio: 3/2;
            display: grid;

            &:has([data-sel]) {
                grid-row: 1;
            }
        }
    }
    button {
        --sel-color: silver;

        &[data-sel=leading] {
            --sel-color: var(--leading-color);
        }
        &[data-sel=supporting] {
            --sel-color: var(--supporting-color);
        }

        &[data-sel] {
            border-color: var(--sel-color);
            outline: 1px solid var(--sel-color);
        }

        & [data-mode] {
            display: none;
        }
        &[data-sel=leading] [data-mode=leading],
        &[data-sel=supporting] [data-mode=supporting] {
            display: block;
            color: var(--sel-color);
        }   
    }

    
    &[data-mode=leading] {
        --local-color: var(--leading-color);
    }
    &[data-mode=supporting] {
        --local-color: var(--supporting-color);
    }

    &::backdrop {
        background-color: oklch(from var(--local-color) l c h / 0.3);
    }

}

@property --combine-angle {
    syntax: "<angle>";
    inherits: false;
    initial-value: 0deg;
}
@keyframes rotate-border {
    to { --combine-angle: 360deg; }
}
@property --gradient-alpha {
    syntax: "<number>";
    inherits: false;
    initial-value: 1.0;
}


#combine-button {
    display: block;
    margin: 1em auto;
    padding: 1em 2em;
    font-family: 'Josefin Sans', sans-serif;

    border: 4px solid transparent;
    border-radius: 1em;
    corner-shape: squircle;

    --clr1: var(--theme-grey);
    --clr2: var(--theme-grey);
    --gradient-alpha: 0.5;
    --clr1a: oklch(from var(--clr1) l c h / var(--gradient-alpha));
    --clr1b: oklch(from var(--clr1) l c h / calc(var(--gradient-alpha)/2));
    --clr2a: oklch(from var(--clr2) l c h / var(--gradient-alpha));
    --clr2b: oklch(from var(--clr2) l c h / calc(var(--gradient-alpha)/2));

    background: 
        linear-gradient(Canvas 0 0) padding-box, 
        conic-gradient(
            from var(--combine-angle),
            var(--clr1b),
            var(--clr1a) 170deg 180deg,
            var(--clr2b) 180deg,
            var(--clr2a) 350deg 360deg
        ) border-box;

    animation: rotate-border 4s linear infinite paused;
    transition: --gradient-alpha 0.2s linear;

    &:hover,
    &:focus {
        animation-play-state: running;
        filter: brightness(0.97);
        --gradient-alpha: 1.0;
    }
    &[data-leading=y] {
        --clr2: var(--leading-color);
    }
    &[data-supporting=y] {
        --clr1: var(--supporting-color);
    }
}




.icon {
    max-width: 1em;
    max-height: 1em;

    &:not(.icon-colored) {
        @media (prefers-color-scheme: dark) {
            filter: invert();
        }
    }
}
.inline-range {
    background-image: url(./img/icon/RangeArrow.svg);
    width: 2.4rem;
    display: inline-block;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: bottom;
    text-align: center;
    font-size: large;
    font-weight: bold;

    @media (prefers-color-scheme: dark) {
        color: black; /* todo: separate text from icon element*/
        filter: invert();
    }

}

.keep-together {
    /* display: inline-block; */
    white-space: nowrap;
}

.flag-button {
    display: grid;
    grid-template-areas: 'a';
    align-items: center;
    padding: 0.5ch;

    --flag-bg: url(./img/flag-svg/none.svg);

    color: var(--fg);
    background-color: var(--bg);
    background-image: radial-gradient(rgb(from var(--bg) r g b / 50%) 0%, rgb(from var(--bg) r g b / 20%) 100%),
        var(--flag-bg);
    background-position: center;
    background-size: cover;
    background-repeat: no-repeat;

    border: 1px solid silver;
    border-radius: 3px;

    &:hover {
        filter: brightness(0.97);
    }


    & > * {
        grid-area: a;
        z-index: 1;
    }

    & > [data-mode="leading"] {
        align-self: end;
        justify-self: start;
        text-shadow: white 0 0 1px, white 0 0 3px, white 0 0 6px;
    }

    & > [data-mode="supporting"] {
        align-self: end;
        justify-self: end;
        text-shadow: white 0 0 1px, white 0 0 3px, white 0 0 6px;
    }

    & .flag-text {
        justify-self: center;
        padding: 1ch;
        background-color: hsl(from var(--bg) h s l / 0.8);
        color: var(--fg);
        border: 1px solid hsl(0 0 0 / 0.8);
        border-color: rgb(from var(--local-color) r g b / 0.8);
        border-radius: 1ch;
        corner-shape: scoop;

        i {
            display: inline-block;
        }
    }
    
}

.altag {
    display: inline-flex;
    gap: 2px;
    border: 1px solid silver;
    padding-right: 2px;
    border-radius: 0 3px 3px 0;
    height: 1.1em;

    .altag_flag {
        display: inline-block;
        /* height: 1em; */
        aspect-ratio: 3 / 2;
        background-image: var(--flag-bg);
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        /* border: 1px solid silver; */
        border-right: 1px solid silver;
    }

    .altag_level {
        font-size: 90%;
        align-self: center;
    }
}

.effect-detail {
    &.effect-type-loss {
        border-left: 5px solid var(--loss-color);
        padding-left: 3px;
    }
    &.effect-type-esc {
        border-left: 5px solid var(--leading-color);
        padding-left: 3px;
        &.effect-src-S {
            border-left-color: var(--supporting-color);
        }
    }
    &.effect-type-mult {
        border-left: 5px solid var(--theme-grey);
        padding-left: 3px;
    }
}
.effect-name {
    font-weight: bold;
    font-size: small;
}
.effect-xtext {
    font-style: italic;
    font-size: 95%;
}

.effect-list {
    margin-block: 2em;

    > [data-container] {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.5ch;
        
        > article {
            display: grid;
            grid-column: 1 / -1;
            grid-template-columns: subgrid;
        }
    }

    > ul {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.5ch;
        margin: 0;
        padding: 0;
        list-style-type: none;
        > li {
            display: grid;
            grid-column: span 2;
            grid-template-columns: subgrid;
            > article {
                display: grid;
                grid-column: span 2;
                grid-template-columns: subgrid;
            }
        }
    }
    & .effect-header {
        grid-column: 1 / -1;
    }
}
.fear-deck {
    display: flex;
    gap: 1ch;
    height: 1.3em;
    align-items: center;

    .tl { height: 100%; }
}
